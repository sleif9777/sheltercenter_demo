<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    {% load static %}
    <meta charset="utf-8">
    <title></title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato">
    <link rel="stylesheet"  href="{%  static  'main.css'  %}">
  </head>
  <body>

    <div class="activitymenu">
      <a href="https://savinggracenc.org/" target="_blank"><img src="{% static 'media/logo.png' %}" alt=""></a>

      <nav>
        <div class="actmenu-center">
          <ul>
            <li class="end"><a href="{% url 'calendar' 'greeter' %}">Calendar</a> </li>
          </ul>
        </div>
      </nav>
    </div>

    <div class="main">
        <div class="roleselector">
          <nav>
            <div class="roleselector-center">
              <ul>
                <li><a href="{% url 'calendar' 'admin' %}">Admin</a></li>
                <li><a href="{% url 'select_adopter' %}">Adopter</a></li>
                <li><a href="{% url 'calendar' 'greeter' %}">Greeter</a> </li>
              </ul>
            </div>
          </nav>
        </div>

        <div class="page_header">
          <h1><a href="{% url 'calendar_date' role previous_day.year previous_day.month previous_day.day %}">&#9664;&#xFE0E;</a>  {{date_pretty}}  <a href="{% url 'calendar_date' role next_day.year next_day.month next_day.day %}">&#9654;&#xFE0E;</a></h1>
        </div>

        <div class="calendar_actions">
          <a href="{% url 'jump_to_date_admin' role %}">Jump To Date</a>
          <a href="{% url 'calendar' 'greeter' %}">Return to Today</a>
        </div>

        {% for timeslot, appointments in timeslots.items %}
          <div class="timeslot">

            <!-- two-column table displaying timeslot and timeslot-level actions -->
            <table style = "width:100%; padding: 10px; margin: 0;">
              <th style="font-size: 18pt; text-align: left;" class="timeslotheader">{{timeslot}}</th>
              <th style="font-size: 18pt; text-align: right;" class="timeslotheader"></th>
            </table>

            <!-- if zero or one appointments, use appt_solo (has margin: auto; and column-count: 1;) to center a single appointment -->
            {% if appointments|length <= 1 %}
            <ul class="appt_solo">
            <!-- else use appt_list for two-column responsive layout  -->
            {% else %}
            <ul class="appt_list">
            {% endif %}

            {% for appt in appointments %}
              <!-- create a list item -->
              <li class="appt_slot">
                <div class="appointment">

                  <!-- header grid, has a bottom border unless it is the only section -->
                  <!-- it will be the only section when the appointment is not booked and has no notes -->
                  {% if appt.internal_notes or appt.adopter_notes or appt.adopter_choice.app_interest %}
                    <table class="appt_info_block" id="appt_header_block">
                  {% else %}
                    <table class="appt_info_block appt_end_block" id="appt_header_block">
                  {% endif %}

                    <tr>
                      <td class="appt_description left upper"><b><p class="appt_action">{{appt}}</p>
                      {% if appt.mobility %}
                        &#9855;&#xFE0E;
                      {% endif %}
                      {% if appt.bringing_dog %}
                        &#128021;&#xFE0E;
                      {% endif %}
                      {% if appt.has_cat %}
                        &#128008;&#xFE0E;
                      {% endif %}
                      </td>

                      <td class="appt_description right"></td>
                    </tr>

                    <tr>
                      <td class="left"><b>({{appt.appt_string}})</b></td>
                      <td class="right">
                        <!-- displays bringing dog if applicable, bumps up has a cat if applicable -->
                        {% if appt.bringing_dog %}
                          <b>Bringing dog!<br></b>
                        {% elif appt.has_cat and not appt.bringing_dog %}
                          <b>Has a cat!</b>
                        {% endif %}
                      </td>
                    </tr>

                    <tr>
                      <td class="left">
                        <!-- displays number_of_visits if second visit or greater -->
                        {% if appt.adopter_choice.visits_to_date > 1 %}
                          <b>{{appt.adopter_choice.number_of_visits}}</b>
                        {% endif %}
                      </td>
                      <td class="right">
                        <!-- displays has a cat if applicable and bringing dog -->
                        {% if appt.bringing_dog and appt.has_cat %}
                          <b>Has a cat!</b>
                        {% endif %}
                      </td>
                    </tr>

                  <!-- end header table -->
                  </table>


                  {% if appt.internal_notes or appt.adopter_notes or appt.adopter_choice.app_interest %}

                    <!-- if the appt has an adopter attached, there should be options for contact and other actions -->
                    {% if appt.appt_type in schedulable and appt.available == False %}
                      <table class="appt_subblock appt_info_block">
                    <!-- if not, it is an open appointment, paperwork, or surrender and could have notes at most -->
                    {% else %}
                      <table class="appt_subblock appt_info_block appt_end_block">
                    {% endif %}

                      <tr class="info_block_subheader">
                        <th class="left"><p>Notes</p></th>
                        <th class="right"></th>
                      </tr>

                      {% if appt.internal_notes %}
                      <tr>
                        <td class="left"><b>From Adoptions:</b></td>
                        <td class="left"><a href="{% url 'edit_cal_appointment' role appt.id date.year date.month date.day %}"> {{appt.internal_notes|linebreaks}}</a></td>
                      </tr>
                      {% endif %}

                      {% if appt.adopter_notes %}
                      <tr>
                        <td class="left"><b>From {{appt.adopter_choice.adopter_first_name}}:</b></td>
                        <td class="left">{{appt.adopter_notes|linebreaks}}</td>
                      </tr>
                      {% endif %}

                      {% if appt.adopter_choice.app_interest %}
                      <tr>
                        <td class="left"><b>From Shelterluv:</b></td>
                        <td class="left">{{appt.adopter_choice.app_interest|linebreaks}}</td>
                      </tr>
                      {% endif %}

                    </table>
                  {% endif %}

                  <!-- if appt is booked, show actions and contacts -->
                  {% if appt.appt_type in schedulable and appt.available == False %}

                    <!-- actions table will always be last (if present) -->
                    <table class="appt_subblock appt_info_block appt_end_block">

                      <tr class="info_block_subheader">
                        <th>Follow-Ups</th>
                        <th class="right">&#128498;&#xFE0E;</th>
                      </tr>

                      <tr>
                        <td>
                          {% if appt.outcome == "1" %}
                            <a href="{% url 'enter_decision' role appt.id date.year date.month date.day%}">Enter Decision</a>
                          {% else %}
                            {% if appt.outcome == "5" %}
                              <a href="{% url 'enter_decision' role appt.id date.year date.month date.day%}">{{appt.get_outcome_display}}</a>
                            {% else %}
                              <a href="{% url 'enter_decision' role appt.id date.year date.month date.day%}">{{appt.get_outcome_display}}: {{appt.dog.upper}}</a>
                            {% endif %}
                          {% endif %}
                        </td>

                        <td class="right"><a href="{% url 'greeter_reschedule' role appt.adopter_choice.id appt.id date.year date.month date.day %}">Schedule Next Appointment</a></td>
                      </tr>

                      <tr>
                        {% if appt.comm_followup == False %}
                          <td><a href="{% url 'send_followup' role appt.id date.year date.month date.day %}">Send Follow-Up Email</a><br></td>
                          <td class="right"><a href="{% url 'send_followup_w_host' role appt.id date.year date.month date.day %}">Send Follow-Up Email (with Host Info)</a><br></td>
                        {% else %}
                          <td><p class="completed_appt_action">Send Follow-Up Email</p></td>
                          <td class="right"><p class="completed_appt_action">Send Follow-Up Email (with Host Info)</p></td>
                        {% endif %}
                      </tr>


                    </table>

                  <!-- endif for booked appt blocks   -->
                  {% endif %}

                <!-- /div for appointment block -->
                </div>
              </li>

            <!-- endfor and /ul for appointments -->
            {% endfor %}
            </ul>

          <!-- /div and endfor for timeslot   -->
          </div>
        {% endfor %}


    </div>

    <br><br>

  </body>
</html>
