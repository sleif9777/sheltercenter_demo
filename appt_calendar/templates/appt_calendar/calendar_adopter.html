<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    {% load static %}
    <meta charset="utf-8">
    <title></title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato">
    <link rel="stylesheet"  href="{%  static  'main.css'  %}">
  </head>
  <body>
    <div class="roleselector">
      <nav>
        <div class="roleselector-center">
          <ul>
            <li><a href="{% url 'calendar' 'admin' %}">Admin</a></li>
            <li><a href="{% url 'select_adopter' %}">Adopter</a></li>
            <li><a href="{% url 'calendar' 'greeter' %}">Greeter</a> </li>
          </ul>
        </div>
      </nav>
    </div>
    <div class="activitymenu">
      <nav>
        <div class="actmenu-center">
          <ul>
            <li><a href="{% url 'adopter_home' adopter.id %}">Calendar</a></li>
            <li><a href="{% url 'faq' adopter.id %}">FAQ</a></li>
            {% if adopter.has_current_appt == True %}
              <li><a href="{% url 'visitor_instructions' adopter.id %}">Visitor Instructions</a></li>
            {% endif %}
            <li><a href="{% url 'contact_us' adopter.id %}">Contact Us</a></li>
          </ul>
        </div>
      </nav>
    </div>

<!-- displays date and arrows for directions -->
    <div class="calendar_header">
      <h1>
        {% if delta > 0 %}
          <a href="{% url 'adopter_calendar_date' 'adopter' adopter.id previous_day.year previous_day.month previous_day.day %}">&#9664;</a>
        {% endif %}
        &#160;{{date_pretty}}  <a href="{% url 'adopter_calendar_date' 'adopter' adopter.id next_day.year next_day.month next_day.day %}">&#9654;</a></h1>
    </div>

<!-- displays actions underneath the date -->
    <div class="calendar_actions">
      <a href="{% url 'jump_to_date_adopter' role adopter.id %}">Jump To Date</a>
      {% if date != today %}
        <a href="{% url 'adopter_calendar_date' 'adopter' adopter.id today.year today.month today.day %}">Return to Today</a>
      {% endif %}
    </div>

    <div class="adopter_messages">
      <p class="greeting"><b>Hello, {{adopter.adopter_first_name}}!</b></p><br>

      {% if has_current_appt == True %}
        Your appointment is currently set for {{current_appt_str}}.<br>
        {% if current_appt.adopter_notes %}
          <b>Your notes: </b> "{{current_appt.adopter_notes}}"<br>
        {% endif %}
        <b><a class="standalone" href="{% url 'edit_cal_appointment' 'adopter' current_appt.id date.year date.month date.day %}">Click here to edit your appointment notes.</a></b>
        {% if visible == True %}
          <br><br>Click any open slot below to reschedule your appointment. We only book one appointment per adopter at a time. By booking any appointment below, you will forfeit your current appointment slot.
          <br><br><b><a class="standalone" href="{% url 'validate' 'adopter' 'cancel' adopter.id current_appt.id date.year date.month date.day %}">Click here to cancel your appointment.</a></b>
        {% endif %}
      {% else %}
        You do not currently have an appointment. Click any open slot below to schedule your appointment.
      {% endif %}

      {% if date.weekday == 5 or date.weekday == 6 %}
        <br><br>
        <p><b>We are not open on weekends.</b></p>
      {% endif %}

      {% if visible == False %}
        {% if date.weekday < 5 %}
          <br><br>
          <p>We only schedule two weeks in advance, and are not scheduling for this date yet.
          {% if adopter.alert_date == date %}
            We will alert you when appointments for this date are open.
          {% else %}
            <a class="standalone" href="{% url 'set_alert_date' role adopter.id date.year date.month date.day %}">Please click here to be alerted when we have opened appointments for this date.</a>
          {% endif %}
          </p>
        {% endif %}
      {% else %}

    </div>

    {% for timeslot, appointments in timeslots.items %}
      {% if timeslot in open_timeslots %}
      <div class="timeslot">
        <h2 class="timeslotheader">{{timeslot}}</h2>
        {% for appt in appointments %}
            {% if appt.available == True and appt.appt_type in schedulable %}
              <div class="appointment">
                {% if has_current_appt == False %}
                    <div class="appt_description appt_action">
                      <p><a href="{% url 'book_cal_appointment' 'adopter' adopter.id appt.id date.year date.month date.day %}">{{appt}}</a></p>
                    </div>
                  {% else %}
                    <div class="appt_description appt_action">
                      <p><a href="{% url 'validate' 'adopter' 'reschedule' adopter.id appt.id date.year date.month date.day %}">{{appt}}</a></p>
                    </div>
                {% endif %}
              </div>
            {% elif appt.available == False and appt.adopter_choice == adopter and appt.appt_type in schedulable %}
              <div class="appointment">
                <div class="appt_description appt_action">
                  <p><a href="{% url 'book_cal_appointment' 'adopter' adopter.id appt.id date.year date.month date.day %}">{{appt}}</a></p>
                </div>
                <div class="appt_notes">
                  <em>
                  {% if appt.adopter_notes %}
                    <a href="{% url 'book_cal_appointment' 'adopter' adopter.id appt.id date.year date.month date.day %}">"{{appt.adopter_notes}}"</a><br>
                  {% endif %}
                  {% if appt.bringing_dog %}
                    <b>Bringing dog</b>
                  {% endif %}
                  </em>
                </div>
                <div class="appt_action">
                  <a href="{% url 'book_cal_appointment' 'adopter' adopter.id appt.id date.year date.month date.day %}">Edit My Appointment Notes</a><br>
                  <a href="{% url 'validate' 'adopter' 'cancel' adopter.id appt.id date.year date.month date.day %}">Cancel My Appointment</a>
                </div>
                <br>
              </div>
            {% endif %}
        {% endfor %}
      </div>
      {% endif %}
    {% endfor %}

    {% endif %}
    <br>

  </body>
</html>
