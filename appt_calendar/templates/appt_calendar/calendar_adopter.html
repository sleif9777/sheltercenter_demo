<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    {% load static %}
    <meta charset="utf-8">
    <title></title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato">
    <link rel="stylesheet"  href="{%  static  'main.css'  %}">
  </head>

  <body>

    <div class="activitymenu">
      <a href="https://savinggracenc.org/" target="_blank"><img src="{% static 'media/logo.png' %}" alt=""></a>

      <nav>
        <div class="actmenu-center">
          <ul>
            <li><a href="{% url 'adopter_home' adopter.id %}">Calendar</a></li>
            <li><a href="{% url 'faq' adopter.id %}">FAQ</a></li>
            {% if adopter.has_current_appt == True %}
              <li><a href="{% url 'visitor_instructions' adopter.id %}">Visitor Instructions</a></li>
            {% endif %}
            <li class="end"><a href="{% url 'contact_us' adopter.id %}">Contact Us</a></li>
          </ul>
        </div>
      </nav>

    </div>

    <div class="main">

      <!-- need to get rid of before live -->
      <div class="roleselector">
        <nav>
          <div class="roleselector-center">
            <ul>
              <li style="color: white;">FOR TEST PURPOSES ONLY</li>
              <li><a href="{% url 'calendar' 'admin' %}">Admin</a></li>
              <li><a href="{% url 'select_adopter' %}">Adopter</a></li>
              <li><a href="{% url 'calendar' 'greeter' %}">Greeter</a> </li>
            </ul>
          </div>
        </nav>
      </div>

      <div class="page_header">
        <h1>
          <!-- display left arrow only if date is in future -->
          {% if delta > 0 %}
            <a href="{% url 'adopter_calendar_date' 'adopter' adopter.id previous_day.year previous_day.month previous_day.day %}">&#9664;&#xFE0E;</a>
          {% endif %}

          &#160;&#xFE0E;{{date_pretty}}
          <a href="{% url 'adopter_calendar_date' 'adopter' adopter.id next_day.year next_day.month next_day.day %}">&#9654;&#xFE0E;</a>
        </h1>
      </div>

      <div class="calendar_actions">
        <a href="{% url 'jump_to_date_adopter' role adopter.id %}">Jump To Date</a>

        {% if date != today %}
          <a href="{% url 'adopter_calendar_date' 'adopter' adopter.id today.year today.month today.day %}">Return to Today</a>
        {% endif %}

      </div>

      <div class="adopter_messages">
        <p class="greeting"><b>Hello, {{adopter.adopter_first_name}}!</b></p><br>

        {% if has_current_appt == True %}
          Your appointment is currently set for {{current_appt_str}}.<br>

          <div class="appointment">
            <!-- header grid, has a bottom border unless it is the only section -->
            <!-- it will be the only section when the appointment has no notes -->
            {% if current_appt.adopter_notes %}
              <table class="appt_info_block" id="appt_header_block">
            {% else %}
              <table class="appt_info_block appt_end_block" id="appt_header_block">
            {% endif %}

              <tr>
                <td class="appt_description left upper"><b><a class="appt_action" href="{% url 'edit_cal_appointment' 'adopter' current_appt.id date.year date.month date.day %}">{{current_appt_str}} - {{current_appt}}</a>

                {% if current_appt.mobility %}
                  &#9855;&#xFE0E;
                {% endif %}
                {% if current_appt.bringing_dog %}
                  &#128021;&#xFE0E;
                {% endif %}
                {% if current_appt.has_cat %}
                  &#128008;&#xFE0E;
                {% endif %}
                </td>

                <td class="appt_description right"><a href="{% url 'book_cal_appointment' 'adopter' adopter.id current_appt.id date.year date.month date.day %}">&#9998;&#xFE0E;</a><a href="{% url 'validate' 'adopter' 'cancel' adopter.id current_appt.id date.year date.month date.day %}">&#10006;&#xFE0E;</a></td>

              </tr>

              <tr>
                <td class="left" style="vertical-align: top;"><b>({{current_appt.appt_string}})</b></td>
                <td class="right">
                  {% if current_appt.bringing_dog %}
                    <b>Bringing dog!<br></b>
                  {% endif %}
                  {% if current_appt.has_cat %}
                    <b>Has a cat!</b>
                  {% endif %}
                </td>
              </tr>

            </table>

            {% if current_appt.adopter_notes %}
              <table class="appt_subblock appt_info_block">

                <tr class="info_block_subheader">
                  <th class="left"><a href="{% url 'edit_cal_appointment' role current_appt.id date.year date.month date.day %}">Notes</a></th>
                  <th class="right"><a href="{% url 'edit_cal_appointment' role current_appt.id date.year date.month date.day %}">&#9998;&#xFE0E;</a></th>
                </tr>

                <tr>
                  <td class="left">{{current_appt.adopter_notes|linebreaks}}</td>
                  <td></td>
                </tr>

              </table>
            {% endif %}

            <table class="appt_subblock appt_info_block appt_end_block">

              <tr>
                <td class="left"><a href="{% url 'validate' 'adopter' 'cancel' adopter.id current_appt.id date.year date.month date.day %}">Cancel My Appointment</a></td>
                <td></td>
              </tr>

            </table>
          </div>

          {% if visible == True %}
            <br><br>Click any open slot below to reschedule your appointment. We only book one appointment per adopter at a time. By booking any appointment below, you will forfeit your current appointment slot.
            <br><br><b><a class="standalone" href="{% url 'validate' 'adopter' 'cancel' adopter.id current_appt.id date.year date.month date.day %}">Click here to cancel your appointment.</a></b>
          {% endif %}
        {% else %}
          You do not currently have an appointment. Click any open slot below to schedule your appointment.
        {% endif %}

        {% if date.weekday == 5 or date.weekday == 6 %}
          <br><br>
          <p><b>We are not open on weekends.</b></p>
        {% endif %}

        {% if visible == False %}
          {% if date.weekday < 5 %}
            <br><br>
            <p>We only schedule two weeks in advance, and are not scheduling for this date yet.
            {% if adopter.alert_date == date %}
              We will alert you when appointments for this date are open.
            {% else %}
              <a class="standalone" href="{% url 'set_alert_date' role adopter.id date.year date.month date.day %}">Please click here to be alerted when we have opened appointments for this date.</a>
            {% endif %}
            </p>
          {% endif %}
        {% else %}
      </div>

          {% for timeslot, appointments in timeslots.items %}

            {% if timeslot in open_timeslots %}
              <div class="timeslot">

                <!-- two-column table displaying timeslot and timeslot-level actions -->
                <table style = "width:100%; padding: 10px; margin: 0;">
                  <th style="font-size: 18pt; text-align: left;" class="timeslotheader">{{timeslot}}</th>
                  <th style="font-size: 18pt; text-align: right;" class="timeslotheader"></th>
                </table>

                <!-- if zero or one appointments, use appt_solo (has margin: auto; and column-count: 1;) to center a single appointment -->
                {% if appointments|length <= 1 %}
                <ul class="appt_solo">
                <!-- else use appt_list for two-column responsive layout  -->
                {% else %}
                <ul class="appt_list">
                {% endif %}

                {% for appt in appointments %}

                  <!-- format for open appointments -->
                  {% if appt.available == True and appt.appt_type in schedulable %}
                    <li class="appt_slot">
                      <div class="appointment">
                        <!-- header grid, has a bottom border unless it is the only section -->
                        <!-- it will be the only section when the appointment is not booked and has no notes -->
                        {% if appt.adopter_notes %}
                          <table class="appt_info_block" id="appt_header_block">
                        {% else %}
                          <table class="appt_info_block appt_end_block" id="appt_header_block">
                        {% endif %}

                          <tr>
                            {% if appt.available == True and appt.appt_type in schedulable %}
                              {% if not has_current_appt %}
                                <td class="appt_description left upper"><b><a href="{% url 'book_cal_appointment' 'adopter' adopter.id appt.id date.year date.month date.day %}">CLICK TO BOOK</a></b></td>
                              {% else %}
                                <td class="appt_description left upper"><b><a href="{% url 'adopter_reschedule' 'adopter' adopter.id appt.id date.year date.month date.day %}">CLICK TO RESCHEDULE</a></b></td>
                              {% endif %}
                            {% endif %}
                          </tr>

                          <tr>
                            <td class="left"><b>({{appt.appt_string}})</b></td>
                            <td class="right"></td>
                          </tr>

                          {% if appt.available and appt.appt_type in schedulable and has_current_appt %}
                            <tr>
                              <td class="left" style="font-size: 10pt; padding-top: 5px;">By scheduling this appointment, you will forfeit your current appt for {{current_appt_str}}.</td>
                              <td></td>
                            </tr>

                          {% endif %}


                        </table>
                      </div>
                    </li>

                  <!-- format for adopter's current appt   -->
                  {% elif appt.available == False and appt.adopter_choice == adopter and appt.appt_type in schedulable %}
                    <li class="appt_slot">
                      <div class="appointment">
                        <!-- header grid, has a bottom border unless it is the only section -->
                        <!-- it will be the only section when the appointment has no notes -->
                        {% if appt.adopter_notes %}
                          <table class="appt_info_block" id="appt_header_block">
                        {% else %}
                          <table class="appt_info_block appt_end_block" id="appt_header_block">
                        {% endif %}

                          <tr>
                            <td class="appt_description left upper"><b><a class="appt_action" href="{% url 'edit_cal_appointment' 'adopter' appt.id date.year date.month date.day %}">{{appt}}</a>

                            {% if appt.mobility %}
                              &#9855;&#xFE0E;
                            {% endif %}
                            {% if appt.bringing_dog %}
                              &#128021;&#xFE0E;
                            {% endif %}
                            {% if appt.has_cat %}
                              &#128008;&#xFE0E;
                            {% endif %}
                            </td>

                            <td class="appt_description right"><a href="{% url 'book_cal_appointment' 'adopter' adopter.id appt.id date.year date.month date.day %}">&#9998;&#xFE0E;</a><a href="{% url 'validate' 'adopter' 'cancel' adopter.id appt.id date.year date.month date.day %}">&#10006;&#xFE0E;</a></td>

                          </tr>

                          <tr>
                            <td class="left" style="vertical-align: top;"><b>({{appt.appt_string}})</b></td>
                            <td class="right">
                              {% if appt.bringing_dog %}
                                <b>Bringing dog!<br></b>
                              {% endif %}
                              {% if appt.has_cat %}
                                <b>Has a cat!</b>
                              {% endif %}
                            </td>
                          </tr>

                        </table>

                        {% if appt.adopter_notes %}
                          <table class="appt_subblock appt_info_block">

                            <tr class="info_block_subheader">
                              <th class="left"><a href="{% url 'edit_cal_appointment' role appt.id date.year date.month date.day %}">Notes</a></th>
                              <th class="right"><a href="{% url 'edit_cal_appointment' role appt.id date.year date.month date.day %}">&#9998;&#xFE0E;</a></th>
                            </tr>

                            <tr>
                              <td class="left">{{appt.adopter_notes|linebreaks}}</td>
                              <td></td>
                            </tr>

                          </table>
                        {% endif %}

                        <table class="appt_subblock appt_info_block appt_end_block">

                          <tr>
                            <td class="left"><a href="{% url 'validate' 'adopter' 'cancel' adopter.id appt.id date.year date.month date.day %}">Cancel My Appointment</a></td>
                            <td></td>
                          </tr>

                        </table>
                      </div>
                    </li>
                  {% endif %}

                {% endfor %}
                </ul>
              </div>
            {% endif %}

          {% endfor %}

      {% endif %}
    </div>

  </body>
</html>
