{% extends 'dashboard/base.html' %}
{% load static %}

{% block content %}

<script>
  function filterAdopters() {
    // Declare variables
    var input, filter, ul, li, name, email, i, txtValue;
    input = document.getElementById("searchBar");
    filter = input.value.toLowerCase();
    console.log(filter);
    ul = document.getElementById("adopter-list");
    li = ul.getElementsByClassName("adopter-listing");

    // Loop through all list items, and hide those who don't match the search query
    for (i = 0; i < li.length; i++) {
      name = li[i].getElementsByClassName("adopter-name")[0];
      email = li[i].getElementsByClassName("adopter-email")[0];
      nameTxtValue = name.textContent || name.innerText;
      emailTxtValue = email.textContent || email.innerText;
      if (nameTxtValue.toLowerCase().indexOf(filter) > -1 || emailTxtValue.toLowerCase().indexOf(filter) > -1) {
        // li[i].style.display = "";
        li[i].classList.remove('hide');
      } else {
        li[i].style.display = "none";
      }
    }
  }
</script>

  <div class="main text-page">
    <h1 class="page-header">Manage Adopters</h1>

    <div class="calendar-actions" style="margin-bottom: 15px;">
      <a href="{% url 'send_to_inactive' %}">Send Follow-Up Emails</a>
    </div>

    <input type="text" id="searchBar" onkeyup="filterAdopters()" placeholder="Search by name or email address.">

    <article id="adopter-list">
      <ul class="list-page">
        {% for adopter in adopters %}
          <li class="adopter-listing hide">
            <a class="pink-link" href="{% url 'edit_adopter' adopter.id %}">
              <span class="adopter-name">
                {{adopter}}
                <!-- show block or pending status -->
                {% if adopter.status == "2" %}
                  &#128683;&#xFE0E;
                {% elif adopter.status == "3" %}
                  &#x231B;&#xFE0E;
                {% endif %}
              </span><br>
              <span class="adopter-email">{{adopter.primary_email}}</span>
            </a>
            <ul class="adopter-mgmt-actions"> 
              {% if adopter.status == "1" %}
                <li><a class="pink-link" href="{% url 'resend_invite' adopter.id %}">Resend Invitation</a></li>
                <li><a class="pink-link" href="{% url 'set_alert_mgr' adopter.id %}">Set Reminder</a></li>
              {% endif %}
            </ul>
          </li>
        {% endfor %}
      </ul>
    </article>

  </div>
{% endblock %}
